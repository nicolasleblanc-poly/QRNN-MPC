The following modules were not unloaded:
  (Use "module --force purge" to unload all):

  1) CCconfig        6)  ucx/1.14.1         11) flexiblas/3.3.1
  2) gentoo/2023     7)  libfabric/1.18.0   12) imkl/2023.2.0
  3) gcccore/.12.3   8)  pmix/4.2.4         13) StdEnv/2023
  4) gcc/12.3        9)  ucc/1.2.0
  5) hwloc/2.9.1     10) openmpi/4.1.5
prob  LunarLanderContinuous 

all methods 

costs  tensor([nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan,
        nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan,
        nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan,
        nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan, nan,
        nan, nan, nan, nan], grad_fn=<AddBackward0>) 

best_action_sequence  [ 1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.  1.
  1.  1.  1.  1. nan nan] 

sim_states  tensor([[-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000],
        [-0.9418,  0.1890, -1.8127, -0.4063,  2.6783,  1.2447,  0.0000,  0.0000]]) 

state  [-0.94183904  0.18903953 -1.8127207  -0.40626022  2.6783283   1.2447155
  0.          0.        ] 

particles  [[ 1.  1.  1. ...  1. nan nan]
 [ 1.  1.  1. ...  1. nan nan]
 [ 1.  1.  1. ...  1. nan nan]
 ...
 [ 1.  1.  1. ...  1. nan nan]
 [ 1.  1.  1. ...  1. nan nan]
 [ 1.  1.  1. ...  1. nan nan]] 

Traceback (most recent call last):
  File "/project/6086407/nileb3/QRNN-MPC/Files/run_LLC_50_AS_ba_CEM.py", line 83, in <module>
    episode_rep_rewards_MPC_PF_50NN_WithASGNN_mid, mean_episode_rep_rewards_MPC_PF_50NN_WithASGNN_mid, std_episode_rep_rewards_MPC_PF_50NN_WithASGNN_mid = main_50NN_MSENN_MPC(prob_vars, method_name, model_50NN, replay_buffer_50NN, optimizer_50NN, loss_50NN, model_ASN, replay_buffer_ASN, optimizer_ASN, do_RS, do_QRNN_step_rnd, use_sampling, use_mid, use_ASGNN)
                                                                                                                                                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/project/6086407/nileb3/QRNN-MPC/Files/main_funcs.py", line 110, in main_50NN_MSENN_MPC
    episode_reward_list = start_50NN_MSENN_MPC_wASGNN(prob_vars, env, seed, model_state, replay_buffer_state, optimizer_state, loss_state, model_ASN, replay_buffer_ASN, optimizer_ASN, do_RS, use_sampling, use_mid, use_ASGNN)
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/project/6086407/nileb3/QRNN-MPC/Files/MPC_50NN_MSENN_funcs.py", line 365, in start_50NN_MSENN_MPC_wASGNN
    best_particle, action, best_cost, particles = choose_action_func_50NN_MSENN(prob_vars, state, particles, do_RS, use_sampling, use_mid, use_ASGNN, model_state, model_ASN, episode=episode, step=step, goal_state=prob_vars.goal_state)
                                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/project/6086407/nileb3/QRNN-MPC/Files/choose_action_50NN_MSENN.py", line 85, in choose_action_func_50NN_MSENN
    best_first_action, particles = continuous_cem_func(prob_vars, particles, costs, best_action_sequence)
                                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/project/6086407/nileb3/QRNN-MPC/Files/particle_filtering.py", line 152, in continuous_cem_func
    new_particles = np.random.multivariate_normal(mu.flatten(), sigma, size=num_particles)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "numpy/random/mtrand.pyx", line 4251, in numpy.random.mtrand.RandomState.multivariate_normal
  File "/home/nileb3/myenv/lib/python3.11/site-packages/numpy/linalg/_linalg.py", line 1812, in svd
    u, s, vh = gufunc(a, signature=signature)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/nileb3/myenv/lib/python3.11/site-packages/numpy/linalg/_linalg.py", line 113, in _raise_linalgerror_svd_nonconvergence
    raise LinAlgError("SVD did not converge")
numpy.linalg.LinAlgError: SVD did not converge
